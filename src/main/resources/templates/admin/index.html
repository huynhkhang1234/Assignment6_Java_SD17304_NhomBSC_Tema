<!DOCTYPE html>
<html lang="en" xmlns="http://www.thymeleaf.org">

<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>B.S.C.Team - CarService</title>

<!-- Link To Base CSS -->
	<th:block th:include="/admin/component/_linkCSS :: cssLinks" />
	
</head>


<body>
	<!-- Start Header -->
	<nav th:replace="~{/admin/component/_header :: nav}" ></nav>
	<!-- End Header -->

	<main>

		<!-- Start Menu Aside -->
		<aside th:replace="~{/admin/component/_menu :: aside}" ></aside>
		<!-- End Menu Aside -->

		<section class="middle">
    <div class="header">
        <h1>Overview</h1>
    </div>

    <div class="cards">
        <div class="card">
            <div class="top">
                <div class="left">
                    <h2>Doanh thu</h2>
                </div>
            </div>
            <div class="middle">
                <h1 th:text="${#numbers.formatDecimal(doanhThu, 0, 'COMMA', 0, 'POINT')}"></h1>
                <div class="chip">
                    <img th:src="@{/images/icons8-chart-50.png}" alt="" style="width: 50px;">
                </div>
            </div>
            <div class="bottom"></div>
        </div>
        <!--end of card 1-->
        <div class="card">
            <div class="top">
                <div class="left">
                    <h2>Số lượng</h2>
                </div>
            </div>
            <div class="middle">
                <h1 th:text="${soLuong}"></h1>
                <div class="chip">
                    <img th:src="@{/images/icons8-money-50.png}" alt="" style="width: 50px;">
                </div>
            </div>
            <div class="bottom"></div>
        </div>
        <!--end of card 2-->
        <div class="card">
            <div class="top">
                <div class="left">
                    <h2>Chi phí</h2>
                </div>
            </div>
            <div class="middle">
                <h1>$456,89</h1>
                <div class="chip">
                    <img th:src="@{/images/icons8-expense-64.png}" alt="" style="width: 50px;">
                </div>
            </div>
            <div class="bottom"></div>
        </div>
        <!--end of card 3-->
        <div class="card">
            <div class="top">
                <div class="left">
                    <h2>Chi phí khác</h2>
                </div>
            </div>
            <div class="middle">
                <h1>$456,89</h1>
                <div class="chip">
                    <img th:src="@{/images/icons8-transaction-list-64.png}" alt="" style="width: 40px;">
                </div>
            </div>
            <div class="bottom"></div>
        </div>
        <!--end of card 4-->
    </div>
    <!--end of cards-->

    <div class="monthly-report">
        <div class="report">
            <h3>Doanh thu</h3>
            <div>
                <details>
                    <h1>$29,023</h1>
                    <h6 class="success">+3.5%</h6>
                </details>
                <p class="text-mutes">Compared to 26, 938 last moth</p>
            </div>
        </div>
        <!--end of income report -->
        <div class="report">
            <h3>Số lượng</h3>
            <div>
                <details>
                    <h1>$9,005</h1>
                    <h6 class="danger">-6.5%</h6>
                </details>
                <p class="text-mutes">Compared to $26, 938 last moth</p>
            </div>
        </div>
        <!--end of income Expenses-->
        <div class="report">
            <h3>Chi phí</h3>
            <div>
                <details>
                    <h1>$4,4507</h1>
                    <h6 class="success">+7.1%</h6>
                </details>
                <p class="text-mutes">Compared to 3, 938 last moth</p>
            </div>
        </div>
        <!--end of income Cashback-->
        <div class="report">
            <h3>Chi phí khác</h3>
            <div>
                <details>
                    <h1>$29,023</h1>
                    <h6 class="success">+3.5%</h6>
                </details>
                <p class="text-mutes">Compared to 26, 938 last moth</p>
            </div>
        </div>
        <!--end of income report -->
    </div>
    <!--end of monthy report-->
    <!--biểu đồ-->
    <div class="div-date">
        <div class="alert alert-warning alert-dismissible col-10" role="alert" style="width: 357px;"
             th:if="${message}">
            <div th:text="${message}"></div>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        <form action="/admin/index/thongke" method="POST" class="col-12 d-flex align-items-center">
            <div class="col-6">
                <label for="">Từ:</label>
                <input id="startDate" name="startDate" th:value="${startDate}" type="date" class="form-control">
            </div>
            <div class="col-6">
                <label for="">Đến:</label>
                <input id="endDate" name="endDate" th:value="${endDate}" type="date" class="form-control">
            </div>
            <div class="col-4">
                <button type="submit" class="btn btn-primary">Thống kê</button>
            </div>
        </form>
    </div>
    <div class="row">
        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="list-tab" data-bs-toggle="pill" data-bs-target="#pills-table"
                        type="button" role="tab" aria-controls="pills-table" aria-selected="true">Danh
                    Sách
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="chart-tab" data-bs-toggle="pill" data-bs-target="#pills-chart"
                        type="button" role="tab" aria-controls="pills-chart" aria-selected="false">Sơ đồ
                </button>
            </li>
        </ul>
    </div>
    <div class="tab-content" id="pills-tabContent" >
        <div class="tab-pane fade show active" id="pills-table" role="tabpanel" aria-labelledby="list-tab"
             tabindex="0">
            <div class="table-responsive mt-5" id="pagination" style="overflow-x: auto">
                <table class="table table-bordered" id="myTable">
                    <thead>
                        <tr>
                            <th>Mã hóa đơn</th>
                            <th>Người đặt</th>
                            <th>Số điện thoại</th>
                            <th>Ngày đặt</th>
                            <th class="text-center">Số lượng sản phẩm</th>
                            <th>Tổng tiền</th>
                            <th>Tiền nhận</th>
                            <th>Địa chỉ</th>
                        </tr>
                    </thead>
                    <tbody>
    <tr th:if="${listO == null}">
        <td class="text-center" colspan="8">Không tìm thấy dữ liệu liên quan</td>
    </tr>
    <tr th:each="item : ${listO}">
        <td th:text="${item.id}"></td>
        <td th:text="${item.users.user_names}"></td>
        <td th:text="${item.users.phones}"></td>
        <td>
            <span th:text="${#dates.format(item.create_date, 'dd-MM-yyyy hh:mm')}"></span>
        </td>
        <td class="text-center">
            <span th:text="${#aggregates.sum(item.order_details.![quanlity])}"></span>
        </td>
        <td class="text-center">
            <span th:text="${#numbers.formatDecimal(item.sum_money, 0, 'COMMA', 0, 'POINT')}"></span>
            <span>VNĐ</span>
        </td>
        <td>
            <span th:text="${#numbers.formatDecimal(item.money_received, 0, 'COMMA', 0, 'POINT')}"></span>
            <span>VNĐ</span>
        </td>
        <td th:text="${item.users.address}"></td>
    </tr>
</tbody>
                    
                    </table>
            </div>
        </div>

        <div class="tab-pane fade" id="pills-chart" role="tabpanel" aria-labelledby="chart-tab" tabindex="0"
             style="width: 100%; height: 500px;">
            <canvas id="chart"></canvas>
        </div>
    </div>
    <div class="btn-toolbar" role="toolbar" aria-label="Toolbar with button groups">
  <div  role="group" aria-label="First group">
    <button type="button" class="btn btn-primary" name="first">First</button>
    <button type="button" class="btn btn-primary" name="prev">Prev</button>
    <button type="button" class="btn btn-primary" name="next">Next</button>
    <button type="button" class="btn btn-primary" name="last">Last</button>
    
  </div>

</div>
</section>
<!--end of middle-->
		


		<!--end of right-->

	</main>


	<!-- Link To Chart JS -->
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.6.0/chart.min.js"
		integrity="sha512-GMGzUEevhWh8Tc/njS0bDpwgxdCJLQBWG3Z2Ct+JGOpVnEmjvNx6ts4v6A2XJf1HOrtOsfhv3hBKpK9kE5z8AQ=="
		crossorigin="anonymous" referrerpolicy="no-referrer"></script>

	<!-- Link To Base JS -->
	<th:block th:include="/admin/component/_linkJS :: jsLinks" />
	
	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script type="text/javascript">
var currentPage = 1;
var pageSize = 5; // số dòng hiển thị trên mỗi trang

function paginateTable() {
  var table = document.getElementById("myTable");
  var rows = table.getElementsByTagName("tr");
  var totalPages = Math.ceil((rows.length - 1) / pageSize); // tổng số trang

  // Ẩn tất cả các dòng trong bảng
  for (var i = 1; i < rows.length; i++) {
    rows[i].style.display = "none";
  }

  // Hiển thị dòng trong phạm vi của trang hiện tại
  var start = (currentPage - 1) * pageSize + 1;
  var end = Math.min(start + pageSize - 1, rows.length - 1);
  for (var j = start; j <= end; j++) {
    rows[j].style.display = "";
  }

  // Thay đổi trạng thái của các nút phân trang
   var firstButton = document.querySelector('button[name="first"]');
  var prevButton = document.querySelector('button[name="prev"]');
  var nextButton = document.querySelector('button[name="next"]');
  var lastButton = document.querySelector('button[name="last"]');

  /* firstButton.disabled = currentPage === 1;
  prevButton.disabled = currentPage === totalPages;
  nextButton.disabled = currentPage === totalPages;
  lastButton.disabled = currentPage === 1; */
} 

// Sự kiện click của nút "First"
var firstButton = document.querySelector('button[name="first"]');
firstButton.addEventListener("click", function () {
  currentPage = 1;
  paginateTable();
});

// Sự kiện click của nút "Prev"
var prevButton = document.querySelector('button[name="prev"]');
prevButton.addEventListener("click", function () {
  currentPage--;
  paginateTable();
});

// Sự kiện click của nút "Next"
var nextButton = document.querySelector('button[name="next"]');
nextButton.addEventListener("click", function () {
  currentPage++;
  paginateTable();
});

// Sự kiện click của nút "Last"
var lastButton = document.querySelector('button[name="last"]');
lastButton.addEventListener("click", function () {
  currentPage = totalPages;
  paginateTable();
});

// Gọi hàm phân trang khi trang web được tải
window.addEventListener("load", function () {
  paginateTable();
});



</script>
</body>
</html>